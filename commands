$runtimeRoot = "C:\ProgramData\CentraStage\AEMAgent\.net.runtime\8.0.19\shared"
Test-Path "$runtimeRoot\Microsoft.AspNetCore.App" -PathType Container
# If it exists, list versions:
If (Test-Path "$runtimeRoot\Microsoft.AspNetCore.App") {
    Get-ChildItem "$runtimeRoot\Microsoft.AspNetCore.App" | Select-Object Name
} else {
    "No Microsoft.AspNetCore.App folder found under $runtimeRoot"
}


# Modern, reliable method:
Get-Process -Name dotnet -ErrorAction SilentlyContinue | ForEach-Object {
    $p = $_
    $proc = Get-CimInstance Win32_Process -Filter "ProcessId = $($p.Id)"
    [PSCustomObject]@{
        Id = $p.Id
        Name = $p.ProcessName
        Path = $p.Path
        CommandLine = $proc.CommandLine
    }
}
